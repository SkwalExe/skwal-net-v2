server {
        listen 80;
        return 301 https://$host$request_uri;
}


server {
        listen 443 ssl;
        server_name skwal.net;

        error_page 503 /maintenance.html;

        location /maintenance.html {
                root /home/skwal/skwal-net-v2/extra/;
                internal;
        }

        location /static/ {
                alias /home/skwal/skwal-net-v2/skwal_net/static/;
        }

        location /media/ {
                alias /home/skwal/skwal-net-v2/skwal_net/media/;
        }

        location / {
                if (-f /home/skwal/skwal-net-v2/hooks/maintenance) {
                        return 503;
                }
                proxy_pass http://127.0.0.1:8000;
        }
        ssl_certificate /etc/letsencrypt/live/skwal.net/fullchain.pem; # managed by Certbot
        ssl_certificate_key /etc/letsencrypt/live/skwal.net/privkey.pem; # managed by Certbot
        include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
        ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}